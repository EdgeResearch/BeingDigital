<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title th:text="${argomento.titolo}"></title>

    <!-- Link per Slick Carousel CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel="stylesheet" type="text/css"
          href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>
    <link rel="stylesheet" th:href="@{/stylesheet/argomento.css}" type="text/css"/>
    <link rel="stylesheet" th:href="@{/stylesheet/flashcard.css}" type="text/css"/>
    <link href="/img/Logo.png" rel="shortcut icon"/>
</head>

<body>

<th:block th:include="fragments/header"></th:block>

<div class="racconto">
    <section class="bannerRacconto"
             th:style="'background: linear-gradient(rgba(0, 0, 0, 0.5), #282828c4), url('+@{/copertina(idArgomento=${param.id})}+'); background-size: cover; background-position: center;'">
        <div class="banner-text">
            <h1 th:text="${argomento.titolo}"></h1>
        </div>
    </section>

    <!-- caso in cui l'argomento Ã¨ un racconto (fare controllo migliore) -->
    <div th:if="${argomento.id == 500}">
        <iframe th:replace="presentazionerisorse/racconto :: racconto"></iframe>
    </div>

    <div th:if="${argomento.id != 500}" class="raccontoText">

        <div id="argomentoContent" th:utext="${argomento.corpo}" style="display: none;"></div>
        <!-- Contenitore per le card -->
        <div class="card-container" id="cardContainer">
            <!-- Le card verranno inserite qui dinamicamente -->
        </div>

        <hr class="linea">

        <div class="iframe-row" style="padding-bottom: 50px">
            <iframe th:replace="presentazionerisorse/flashcard :: flashcardContent"></iframe>
        </div>

        <hr class="linea">

        <!-- <svg width="1000" height="1000"></svg> -->

        <!-- Contenitore per la mappa
        <div id="diagram" style="position: relative">
            <div id="myDiagramDiv"
                 style="background-color: #f2f2f2; border: solid 1px black; width: 100%; height: 500px"></div>
            <div id="myOverviewDiv"></div>
        </div> -->

        <div class="box-bottoni">
            <a class="btnUtente" th:if="${lastId != null}" th:href="@{/argomento(id=${lastId})}">Lezione precedente</a>
            <a class="btnUtente" href="/utente/lezioniPrivacy">Lista Lezioni</a>
            <a class="btnUtente" th:if="${nextId != null}" th:href="@{/argomento(id=${nextId})}">Lezione successiva</a>
        </div>
    </div>

</div>


<th:block th:include="fragments/footer"></th:block>
</body>

<!-- Includi lo script lezione_passwordsicura.js -->
<script src="https://unpkg.com/gojs/release/go-debug.js"></script>
<script src="https://d3js.org/d3.v6.min.js"></script>


<!--<script th:src="@{/js/mappe/privacy/base/lezione_passwordsicura.js}"></script> -->

<!-- Caricamento dinamico del file JS della mappa -->
<!-- <script th:src="@{${argomento.mappa}}"></script> -->

<!-- Includi Slick Carousel -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Funzione per inizializzare Slick Carousel
        function initializeCarousel() {
            $('#cardContainer').slick({
                dots: true,
                infinite: true,
                speed: 500,
                slidesToShow: 1,
                slidesToScroll: 1
            });
        }

        // Funzione per creare e aggiungere le card al carosello
        function populateCarousel() {
            // Recupera il contenuto dell'elemento con id 'argomentoContent'
            var content = document.getElementById('argomentoContent').innerHTML;

            // Crea un parser HTML
            var parser = new DOMParser();
            var doc = parser.parseFromString(content, 'text/html');

            // Trova tutti i div nel contenuto
            var divs = doc.querySelectorAll('div');
            var cardContainer = document.getElementById('cardContainer');

            // Aggiungi ogni div come una card al carosello
            divs.forEach(function (div) {
                var card = document.createElement('div');
                card.classList.add('card');
                card.innerHTML = div.innerHTML; // Copia il contenuto del div originale
                cardContainer.appendChild(card);
            });

            // Inizializza il carosello Slick dopo aver aggiunto le card
            initializeCarousel();
        }

        // Chiama la funzione per popolare il carosello
        populateCarousel();
    });
</script>

</html>